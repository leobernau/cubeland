<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Bernau Games - CubeLand</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: Arial, sans-serif;
      color: white;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: #000;
    }
    #menu, #shop {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }
    #menu button, #shop button {
      margin: 10px;
      padding: 15px 30px;
      font-size: 20px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      background: linear-gradient(90deg, #00f, #0ff);
      color: white;
      box-shadow: 0 0 10px #0ff;
      transition: transform 0.2s;
    }
    #menu button:hover, #shop button:hover {
      transform: scale(1.1);
    }
    #hud {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1;
      font-size: 24px;
      text-shadow: 0 0 5px #0ff;
    }
    #shop {
      overflow-y: auto;
    }
    .skin-option {
      background: #111;
      border: 2px solid #0ff;
      padding: 10px;
      margin: 10px;
      border-radius: 12px;
      box-shadow: 0 0 10px #0ff;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="menu">
    <h1>Bernau Games - CubeLand</h1>
    <button id="playBtn">Spielen</button>
    <button id="shopBtn">Shop</button>
  </div>
  <div id="shop" style="display:none;">
    <h2>Shop</h2>
    <div id="skins"></div>
    <button id="closeShop">Zurück</button>
  </div>
  <div id="hud">
    <div id="score">Score: 0</div>
    <div id="highscore">Highscore: 0</div>
    <div id="coins">Münzen: 0</div>
  </div>
  <canvas id="gameCanvas"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let gameRunning = false;
    let paused = false;
    let score = 0;
    let highscore = 0;
    let coins = 0;
    let frameCount = 0;

    const groundHeight = 60;
    const blockSize = 60;

    // Player
    let player = {
      x: 100,
      y: canvas.height - groundHeight - 60,
      size: 50,
      color: "#0ff",
      dy: 0,
      gravity: 0.8,
      jumpPower: -15,
      onGround: true,
      rotation: 0,
      skin: "neonNoir"
    };

    let obstacles = [];
    let coinArray = [];
    let lastObstacleX = canvas.width;

    // Neon helper
    function drawNeonRect(x, y, w, h, color) {
      ctx.shadowBlur = 20;
      ctx.shadowColor = color;
      ctx.fillStyle = color;
      ctx.fillRect(x, y, w, h);
      ctx.shadowBlur = 0;
    }

    function drawNeonTriangle(x, y, size, color) {
      ctx.shadowBlur = 20;
      ctx.shadowColor = color;
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.moveTo(x, y);
      ctx.lineTo(x+size, y+size);
      ctx.lineTo(x-size, y+size);
      ctx.closePath();
      ctx.fill();
      ctx.shadowBlur = 0;
    }

    // Generate obstacles
    function generateObstacle() {
      const gap = 300 + Math.random() * 200;
      if (lastObstacleX < canvas.width - gap) {
        const type = Math.random() < 0.5 ? "block" : "spike";
        if (type === "block") {
          obstacles.push({x: canvas.width, y: canvas.height - groundHeight - blockSize, w: blockSize, h: blockSize, type});
          // Coin on top
          coinArray.push({x: canvas.width + blockSize/2, y: canvas.height - groundHeight - blockSize - 40, size: 20});
        } else {
          obstacles.push({x: canvas.width, y: canvas.height - groundHeight - blockSize, size: blockSize, type});
        }
        lastObstacleX = canvas.width;
      }
    }

    function drawCoin(coin) {
      ctx.beginPath();
      ctx.arc(coin.x, coin.y, coin.size, 0, Math.PI*2);
      ctx.fillStyle = "yellow";
      ctx.shadowBlur = 20;
      ctx.shadowColor = "yellow";
      ctx.fill();
      ctx.shadowBlur = 0;
    }

    function update() {
      if (!gameRunning || paused) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Floor & ceiling
      for (let i=0; i<canvas.width/blockSize; i++) {
        drawNeonRect(i*blockSize, canvas.height-groundHeight, blockSize, groundHeight, "#222");
        drawNeonRect(i*blockSize, 0, blockSize, groundHeight/2, "#222");
      }

      // Player physics
      player.y += player.dy;
      player.dy += player.gravity;

      if (player.y + player.size >= canvas.height - groundHeight) {
        player.y = canvas.height - groundHeight - player.size;
        player.dy = 0;
        player.onGround = true;
      }
      if (player.y <= groundHeight/2) {
        player.y = groundHeight/2;
        player.dy = 0;
      }

      // Obstacles
      obstacles.forEach((obs, i) => {
        if (obs.type === "block") {
          drawNeonRect(obs.x, obs.y, obs.w, obs.h, "#f0f");
        } else {
          drawNeonTriangle(obs.x+obs.size/2, obs.y, obs.size/2, "#f00");
        }
        obs.x -= 6;
        if (obs.x < -200) obstacles.splice(i,1);

        // Collision
        if (obs.type === "block") {
          if (player.x < obs.x+obs.w && player.x+player.size > obs.x && player.y+player.size > obs.y && player.y < obs.y+obs.h) {
            gameOver();
          }
        } else {
          if (player.x < obs.x+obs.size && player.x+player.size > obs.x && player.y+player.size > obs.y) {
            gameOver();
          }
        }
      });

      // Coins
      coinArray.forEach((coin, i) => {
        drawCoin(coin);
        coin.x -= 6;
        if (coin.x < -50) coinArray.splice(i,1);
        if (player.x < coin.x+coin.size && player.x+player.size > coin.x-coin.size && player.y < coin.y+coin.size && player.y+player.size > coin.y-coin.size) {
          coins++;
          document.getElementById("coins").innerText = "Münzen: " + coins;
          coinArray.splice(i,1);
        }
      });

      // Player
      ctx.save();
      ctx.translate(player.x + player.size/2, player.y + player.size/2);
      ctx.rotate(player.rotation * Math.PI/180);
      drawNeonRect(-player.size/2, -player.size/2, player.size, player.size, player.color);
      ctx.restore();

      // Score
      frameCount++;
      if (frameCount % 10 === 0) {
        score++;
        document.getElementById("score").innerText = "Score: " + score;
        if (score > highscore) {
          highscore = score;
          document.getElementById("highscore").innerText = "Highscore: " + highscore;
        }
      }

      lastObstacleX -= 6;
      generateObstacle();

      requestAnimationFrame(update);
    }

    function gameOver() {
      gameRunning = false;
      document.getElementById("menu").style.display = "flex";
    }

    // Controls
    window.addEventListener("keydown", e => {
      if (e.code === "Space" && player.onGround) {
        player.dy = player.jumpPower;
        player.onGround = false;
        player.rotation += 45; // rotate forward
      }
      if (e.code === "KeyS") {
        toggleShop();
      }
      if (e.code === "KeyP") {
        paused = !paused;
        if (!paused) update();
      }
    });

    function startGame() {
      document.getElementById("menu").style.display = "none";
      document.getElementById("shop").style.display = "none";
      score = 0;
      obstacles = [];
      coinArray = [];
      lastObstacleX = canvas.width;
      player.x = 100;
      player.y = canvas.height - groundHeight - player.size;
      player.dy = 0;
      player.rotation = 0;
      gameRunning = true;
      paused = false;
      update();
    }

    function toggleShop() {
      const shop = document.getElementById("shop");
      shop.style.display = (shop.style.display === "none") ? "flex" : "none";
    }

    document.getElementById("playBtn").addEventListener("click", startGame);
    document.getElementById("shopBtn").addEventListener("click", () => {
      document.getElementById("menu").style.display = "none";
      document.getElementById("shop").style.display = "flex";
    });
    document.getElementById("closeShop").addEventListener("click", () => {
      document.getElementById("shop").style.display = "none";
      document.getElementById("menu").style.display = "flex";
    });
  </script>
</body>
</html>
